{"version":3,"names":[],"mappings":"","sources":["app.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nrequire('./setup/jquery');\n\nrequire('./common');\n\nrequire('./modules/resource');\n\nrequire('./modules/fileManager');\n\nrequire('./modules/contentBlocks');\n\nrequire('./modules/googleMaps');\n\nvar _config = require('./setup/config');\n\nvar _config2 = _interopRequireDefault(_config);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar app = angular.module('Mezzo', ['ui.router', 'ui.sortable', 'ngMessages', 'angular-sortable-view', 'angular-loading-bar', 'ngFileUpload', 'MezzoCommon', 'MezzoResources', 'MezzoFileManager', 'MezzoContentBlocks', 'MezzoGoogleMaps']);\n\napp.config(_config2.default);\n\n},{\"./common\":12,\"./modules/contentBlocks\":16,\"./modules/fileManager\":26,\"./modules/googleMaps\":27,\"./modules/resource\":37,\"./setup/config\":40,\"./setup/jquery\":41}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RelationInputController =\n\n/*@ngInject*/\nfunction RelationInputController(api) {\n    var _this = this;\n\n    _classCallCheck(this, RelationInputController);\n\n    this.api = api;\n    this.modelApi = this.api.model(this.related);\n    this.model = null;\n    this.models = [];\n\n    this.modelApi.index({ scopes: this.scopes }).then(function (models) {\n        _this.models = models;\n    });\n};\n\nexports.default = RelationInputController;\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ModelApi = require('./ModelApi');\n\nvar _ModelApi2 = _interopRequireDefault(_ModelApi);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Api = (function () {\n    function Api($http) {\n        _classCallCheck(this, Api);\n\n        this.$http = $http;\n    }\n\n    _createClass(Api, [{\n        key: 'get',\n        value: function get(url, params) {\n            return this.apiPromise(this.$http.get(url, { 'params': params }));\n        }\n    }, {\n        key: 'post',\n        value: function post(url, data) {\n            return this.apiPromise(this.$http.post(url, data));\n        }\n    }, {\n        key: 'put',\n        value: function put(url, data) {\n            return this.apiPromise(this.$http.put(url, data));\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(url) {\n            return this.apiPromise(this.$http.delete(url));\n        }\n    }, {\n        key: 'model',\n        value: function model(modelName) {\n            return new _ModelApi2.default(this, modelName);\n        }\n    }, {\n        key: 'apiPromise',\n        value: function apiPromise($httpPromise) {\n            return $httpPromise.then(function (response) {\n                return response.data.data;\n            }).catch(function (err) {\n                console.error(err);\n                throw err;\n            });\n        }\n    }, {\n        key: 'files',\n        value: function files() {\n            return this.get('/api/files');\n        }\n    }, {\n        key: 'contentBlockTemplate',\n        value: function contentBlockTemplate(hash) {\n            return this.$http.get('/mezzo/content-block-types/' + hash + '.html').then(function (response) {\n                return response.data;\n            }).catch(function (err) {\n                console.error(err);\n                throw err;\n            });\n        }\n    }]);\n\n    return Api;\n})();\n\nexports.default = Api;\n\n},{\"./ModelApi\":4}],4:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ModelApi = (function () {\n    function ModelApi(api, modelName) {\n        _classCallCheck(this, ModelApi);\n\n        this.api = api;\n        this.modelName = modelName;\n        this.modelPlural = pluralize(this.modelName).toLowerCase();\n        this.apiUrl = '/api/' + this.modelPlural;\n    }\n\n    _createClass(ModelApi, [{\n        key: 'index',\n        value: function index(parameters) {\n            return this.api.get(this.apiUrl, parameters);\n        }\n    }, {\n        key: 'create',\n        value: function create(formData) {\n            return this.api.post(this.apiUrl, formData);\n        }\n    }, {\n        key: 'update',\n        value: function update(modelId, formData) {\n            return this.api.put(this.apiUrl + '/' + modelId, formData);\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(modelId) {\n            return this.api.delete(this.apiUrl + '/' + modelId);\n        }\n    }, {\n        key: 'content',\n        value: function content(modelId) {\n            return this.api.get(this.apiUrl + '/' + modelId + '?include=content');\n        }\n    }, {\n        key: 'lock',\n        value: function lock(modelId) {\n            return this.api.get(this.apiUrl + '/' + modelId + '/lock');\n        }\n    }]);\n\n    return ModelApi;\n})();\n\nexports.default = ModelApi;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = apiService;\n\nvar _Api = require('./Api');\n\nvar _Api2 = _interopRequireDefault(_Api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*@ngInject*/\nfunction apiService($http) {\n    return new _Api2.default($http);\n}\n\n},{\"./Api\":3}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = compileDirective;\n/*@ngInject*/\nfunction compileDirective() {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        scope.$watch(attributes.mezzoCompile, function (directive) {\n            if (directive) {\n                var html = '<' + directive + ' >';\n\n                element.html(html);\n                $compile(element.contents())(scope);\n            }\n        });\n    }\n};\n\n},{}],7:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = compileHtmlDirective;\n/*@ngInject*/\nfunction compileHtmlDirective($parse, $compile) {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        var expression = attributes.mezzoCompileHtml;\n        var getter = $parse(expression);\n\n        scope.$watch(getter, function (html) {\n            if (!html) {\n                return;\n            }\n\n            element.html(html);\n            $compile(element.contents())(scope);\n        });\n    }\n}\n\n},{}],8:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = enterDirective;\n/*@ngInject*/\nfunction enterDirective() {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        element.bind('keypress', function (event) {\n            if (event.which === 13) {\n                scope.$eval(attributes.mezzoEnter);\n                scope.$apply();\n            }\n        });\n    }\n}\n\n},{}],9:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = hasControllerService;\n/*@ngInject*/\nfunction hasControllerService($controller) {\n    return hasController;\n\n    function hasController(controllerName) {\n        try {\n            $controller(controllerName);\n\n            return true;\n        } catch (err) {\n            return !(err instanceof TypeError);\n        }\n    }\n}\n\n},{}],10:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = hrefPreventDirective;\n/*@ngInject*/\nfunction hrefPreventDirective() {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        $(element).click(function ($event) {\n            $event.preventDefault();\n        });\n    }\n}\n\n},{}],11:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = hrefReloadDirective;\n/*@ngInject*/\nfunction hrefReloadDirective() {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        var shouldReload = attributes.mezzoHrefReload === '1';\n\n        if (!shouldReload) {\n            return;\n        }\n\n        var $element = $(element);\n\n        $element.click(function ($event) {\n            $event.preventDefault();\n            onHrefClick($element);\n        });\n    }\n\n    function onHrefClick($element) {\n        var href = $element.attr('href');\n\n        if (!href) {\n            return;\n        }\n\n        window.location.href = href;\n    }\n}\n\n},{}],12:[function(require,module,exports){\n'use strict';\n\nvar _compileDirective = require('./compileDirective');\n\nvar _compileDirective2 = _interopRequireDefault(_compileDirective);\n\nvar _compileHtmlDirective = require('./compileHtmlDirective');\n\nvar _compileHtmlDirective2 = _interopRequireDefault(_compileHtmlDirective);\n\nvar _enterDirective = require('./enterDirective.js');\n\nvar _enterDirective2 = _interopRequireDefault(_enterDirective);\n\nvar _relationInputDirective = require('./relationInputDirective');\n\nvar _relationInputDirective2 = _interopRequireDefault(_relationInputDirective);\n\nvar _hrefReloadDirective = require('./hrefReloadDirective');\n\nvar _hrefReloadDirective2 = _interopRequireDefault(_hrefReloadDirective);\n\nvar _hrefPreventDirective = require('./hrefPreventDirective');\n\nvar _hrefPreventDirective2 = _interopRequireDefault(_hrefPreventDirective);\n\nvar _uidService = require('./uidService.js');\n\nvar _uidService2 = _interopRequireDefault(_uidService);\n\nvar _apiService = require('./api/apiService');\n\nvar _apiService2 = _interopRequireDefault(_apiService);\n\nvar _hasControllerService = require('./hasControllerService');\n\nvar _hasControllerService2 = _interopRequireDefault(_hasControllerService);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _module = angular.module('MezzoCommon', []);\n\n_module.directive('mezzoCompile', _compileDirective2.default);\n_module.directive('mezzoCompileHtml', _compileHtmlDirective2.default);\n_module.directive('mezzoEnter', _enterDirective2.default);\n_module.directive('mezzoRelationInput', _relationInputDirective2.default);\n_module.directive('mezzoHrefReload', _hrefReloadDirective2.default);\n_module.directive('mezzoHrefPrevent', _hrefPreventDirective2.default);\n_module.factory('uid', _uidService2.default);\n_module.factory('api', _apiService2.default);\n_module.factory('hasController', _hasControllerService2.default);\n\n},{\"./api/apiService\":5,\"./compileDirective\":6,\"./compileHtmlDirective\":7,\"./enterDirective.js\":8,\"./hasControllerService\":9,\"./hrefPreventDirective\":10,\"./hrefReloadDirective\":11,\"./relationInputDirective\":13,\"./uidService.js\":14}],13:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = relationInputDirective;\n\nvar _RelationInputController = require('./RelationInputController');\n\nvar _RelationInputController2 = _interopRequireDefault(_RelationInputController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*@ngInject*/\nfunction relationInputDirective() {\n    return {\n        restrict: 'E',\n        templateUrl: '/mezzolabs/mezzo/cockpit/templates/relationInputDirective.html',\n        replace: true,\n        scope: {\n            related: '@',\n            scopes: '@'\n        },\n        controller: _RelationInputController2.default,\n        controllerAs: 'vm',\n        bindToController: true\n    };\n}\n\n},{\"./RelationInputController\":2}],14:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = uidService;\nvar id = 0;\n\n/*@ngInject*/\nfunction uidService() {\n    return nextUid;\n}\n\nfunction nextUid() {\n    return id++;\n}\n\n},{}],15:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = registerContentBlockFactory;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*@ngInject*/\nfunction registerContentBlockFactory(api) {\n    return function contentBlockFactory() {\n        return new ContentBlockService(api);\n    };\n}\n\nvar ContentBlockService = (function () {\n    function ContentBlockService(api) {\n        _classCallCheck(this, ContentBlockService);\n\n        this.api = api;\n        this.contentBlocks = [];\n        this.templates = {};\n        this.sortableOptions = {\n            handle: 'a .ion-arrow-move'\n        };\n        this.currentId = 0;\n    }\n\n    _createClass(ContentBlockService, [{\n        key: 'addContentBlock',\n        value: function addContentBlock(key, hash, title) {\n            var id = arguments.length <= 3 || arguments[3] === undefined ? '' : arguments[3];\n\n            var contentBlock = {\n                id: id,\n                key: key,\n                hash: hash,\n                title: title,\n                nameInForm: 'fuck_off_form2js' + this.currentId++,\n                template: null\n            };\n\n            this.fillTemplate(contentBlock);\n            this.contentBlocks.push(contentBlock);\n        }\n    }, {\n        key: 'removeContentBlock',\n        value: function removeContentBlock(index) {\n            this.contentBlocks.splice(index, 1);\n        }\n    }, {\n        key: 'fillTemplate',\n        value: function fillTemplate(contentBlock) {\n            var _this = this;\n\n            var cachedTemplate = this.templates[contentBlock.hash];\n\n            if (cachedTemplate) {\n                return contentBlock.template = cachedTemplate;\n            }\n\n            this.api.contentBlockTemplate(contentBlock.hash).then(function (template) {\n                contentBlock.template = template;\n                _this.templates[contentBlock.hash] = template;\n            });\n        }\n    }]);\n\n    return ContentBlockService;\n})();\n\n},{}],16:[function(require,module,exports){\n'use strict';\n\nvar _contentBlockFactory = require('./contentBlockFactory');\n\nvar _contentBlockFactory2 = _interopRequireDefault(_contentBlockFactory);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _module = angular.module('MezzoContentBlocks', []);\n\n_module.factory('contentBlockFactory', _contentBlockFactory2.default);\n\n},{\"./contentBlockFactory\":15}],17:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Category = function Category(label, icon) {\n    var filter = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n    var everything = arguments.length <= 3 || arguments[3] === undefined ? false : arguments[3];\n\n    _classCallCheck(this, Category);\n\n    this.label = label;\n    this.icon = icon;\n    this.filter = filter;\n    this.everything = everything;\n};\n\nexports.default = Category;\n\n},{}],18:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _File = require('./File');\n\nvar _File2 = _interopRequireDefault(_File);\n\nvar _Folder = require('./Folder');\n\nvar _Folder2 = _interopRequireDefault(_Folder);\n\nvar _categories = require('./categories');\n\nvar _categories2 = _interopRequireDefault(_categories);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CreateFileController = (function () {\n\n    /*@ngInject*/\n\n    function CreateFileController($scope, api, Upload) {\n        _classCallCheck(this, CreateFileController);\n\n        this.$scope = $scope;\n        this.api = api;\n        this.Upload = Upload;\n\n        this.categories = _categories2.default;\n        this.category = this.categories[0];\n        this.orderOptions = ['Title', 'Last modified'];\n        this.orderBy = this.orderOptions[0];\n        this.selected = null;\n\n        this.initFiles();\n    }\n\n    _createClass(CreateFileController, [{\n        key: 'initFiles',\n        value: function initFiles() {\n            var _this = this;\n\n            this.library = new _Folder2.default('Library');\n            this.folder = this.library;\n            this.files = this.library.files;\n\n            this.api.files().then(function (apiFiles) {\n                apiFiles.forEach(function (apiFile) {\n                    var file = new _File2.default(apiFile);\n\n                    _this.library.files.push(file);\n                });\n            });\n        }\n    }, {\n        key: 'isActive',\n        value: function isActive(category) {\n            if (category === this.category) {\n                return 'active';\n            }\n        }\n    }, {\n        key: 'selectCategory',\n        value: function selectCategory(category) {\n            this.category = category;\n        }\n    }, {\n        key: 'selectFile',\n        value: function selectFile(file) {\n            if (file === this.selected) {\n                this.selected = null;\n\n                return;\n            }\n\n            this.selected = file;\n        }\n    }, {\n        key: 'enterFolder',\n        value: function enterFolder(file) {\n            if (file.isFolder) {\n                this.folder = file;\n                this.files = file.files;\n            }\n        }\n    }, {\n        key: 'folderHierarchy',\n        value: function folderHierarchy() {\n            var folders = [];\n            var folder = this.folder;\n\n            while (folder) {\n                folders.push(folder);\n\n                folder = folder.parent;\n            }\n\n            return folders.reverse();\n        }\n    }, {\n        key: 'showFolderHierarchy',\n        value: function showFolderHierarchy() {\n            return this.category.everything && !this.search;\n        }\n    }, {\n        key: 'showCategoryAsFolderHierarchy',\n        value: function showCategoryAsFolderHierarchy() {\n            return !this.category.everything && !this.search;\n        }\n    }, {\n        key: 'addFolder',\n        value: function addFolder(name) {\n            if (!name) {\n                return false;\n            }\n\n            this.folderName = '';\n            var folder = new _Folder2.default(name, this.folder);\n\n            this.folder.files.push(folder);\n            $('#add-folder-modal').modal('hide');\n        }\n    }, {\n        key: 'getFiles',\n        value: function getFiles() {\n            if (this.search) {\n                return this.searchFiles();\n            }\n\n            var category = this.category;\n\n            if (category.everything) {\n                return this.files;\n            }\n\n            var filteredFiles = [];\n\n            this.allFiles().forEach(function (file) {\n                if (category.filter(file)) {\n                    filteredFiles.push(file);\n                }\n            });\n\n            return filteredFiles;\n        }\n    }, {\n        key: 'searchFiles',\n        value: function searchFiles() {\n            var files = this.allFiles();\n            var found = [];\n            var lowerSearch = this.search.toLowerCase();\n\n            files.forEach(function (file) {\n                if (file.title.toLowerCase().indexOf(lowerSearch) !== -1) {\n                    found.push(file);\n                }\n            });\n\n            return found;\n        }\n    }, {\n        key: 'sortedFiles',\n        value: function sortedFiles() {\n            var files = this.getFiles();\n            var folders = [];\n            var notFolders = [];\n\n            files.forEach(function (file) {\n                if (file.isFolder) {\n                    folders.push(file);\n                } else {\n                    notFolders.push(file);\n                }\n            });\n\n            return folders.concat(notFolders);\n        }\n    }, {\n        key: 'allFiles',\n        value: function allFiles() {\n            var _this2 = this;\n\n            var folder = arguments.length <= 0 || arguments[0] === undefined ? this.library : arguments[0];\n\n            var files = [];\n\n            folder.files.forEach(function (file) {\n                files.push(file);\n\n                if (file.isFolder) {\n                    files = files.concat(_this2.allFiles(file));\n                }\n            });\n\n            return files;\n        }\n    }, {\n        key: 'items',\n        value: function items(file) {\n            var count = 0;\n\n            if (file.isFolder) {\n                count = file.files.length;\n            }\n\n            return count + ' ' + (count === 1 ? 'item' : 'items');\n        }\n    }, {\n        key: 'deleteFiles',\n        value: function deleteFiles() {\n            var _this3 = this;\n\n            var file = this.selected;\n\n            if (file) {\n                swal({\n                    title: 'Sind Sie sicher?',\n                    text: 'Die folgenden Dateien werden unwiderruflich gelöscht: ' + file.title,\n                    type: 'warning',\n                    showCancelButton: true,\n                    confirmButtonText: 'Ja, Dateien löschen!',\n                    confirmButtonColor: '#fb503b',\n                    cancelButtonText: 'Abbrechen'\n                }, function (confirmed) {\n                    if (!confirmed) {\n                        return;\n                    }\n\n                    _this3.selected = null;\n\n                    _this3.deleteFile(file);\n                    _this3.$scope.$apply();\n                });\n            }\n        }\n    }, {\n        key: 'deleteFile',\n        value: function deleteFile(file) {\n            for (var i = 0; i < this.files.length; i++) {\n                if (file === this.files[i]) {\n                    this.files.splice(i, 1);\n\n                    return;\n                }\n            }\n        }\n    }, {\n        key: 'moveTo',\n        value: function moveTo(folder) {\n            this.moveFile(this.selected, folder);\n            $('#move-modal').modal('hide');\n            this.enterFolder(folder);\n        }\n    }, {\n        key: 'moveFile',\n        value: function moveFile(file, folder) {\n            this.deleteFile(file);\n\n            if (file.isFolder) {\n                file.parent = folder;\n            }\n\n            folder.files.push(file);\n        }\n    }, {\n        key: 'upload',\n        value: function upload(file) {\n            var _this4 = this;\n\n            this.Upload.upload({\n                url: '/api/files/upload',\n                data: {\n                    file: file\n                },\n                headers: {\n                    Accept: 'application/vnd.MezzoLabs.v1+json'\n                }\n            }).then(function (response) {\n                console.log(response);\n                _this4.initFiles();\n            }).catch(function (err) {\n                console.error(err);\n            });\n        }\n    }, {\n        key: 'onDrop',\n        value: function onDrop(droppable, draggable) {\n            var files = this.sortedFiles();\n            var folderIndex = $(droppable).data('index');\n            var draggedIndex = $(draggable).data('index');\n            var folder = files[folderIndex];\n            var dragged = files[draggedIndex];\n\n            this.moveFile(dragged, folder);\n            this.$scope.$apply();\n        }\n    }]);\n\n    return CreateFileController;\n})();\n\nexports.default = CreateFileController;\n\n},{\"./File\":19,\"./Folder\":21,\"./categories\":22}],19:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar File = (function () {\n    function File(apiFile) {\n        _classCallCheck(this, File);\n\n        this.id = apiFile.id;\n        this.title = apiFile.filename;\n        this.name = apiFile.filename;\n        this.extension = apiFile.extension;\n        this.url = apiFile.url;\n        this.type = apiFile.type;\n        this.isFolder = false;\n    }\n\n    _createClass(File, [{\n        key: 'icon',\n        value: function icon() {\n            if (this.isImage()) {\n                return 'ion-image';\n            }\n\n            if (this.isVideo()) {\n                return 'ion-ios-videocam';\n            }\n\n            if (this.isAudio()) {\n                return 'ion-music-note';\n            }\n\n            if (this.extension === 'pdf') {\n                return 'ion-printer';\n            }\n\n            return 'ion-document';\n        }\n    }, {\n        key: 'isImage',\n        value: function isImage() {\n            return this.hasExtension('png', 'jpg', 'gif', 'jpeg');\n        }\n    }, {\n        key: 'isVideo',\n        value: function isVideo() {\n            return this.hasExtension('mp4', 'avi');\n        }\n    }, {\n        key: 'isAudio',\n        value: function isAudio() {\n            return this.hasExtension('mp3');\n        }\n    }, {\n        key: 'isDocument',\n        value: function isDocument() {\n            return this.hasExtension('txt', 'md', 'pdf');\n        }\n\n        /* public */\n        /* private */\n\n    }, {\n        key: 'hasExtension',\n        value: function hasExtension() {\n            for (var i = 0; i < arguments.length; i++) {\n                if (this.extension === arguments[i]) {\n                    return true;\n                }\n            }\n\n            return false;\n        }\n    }]);\n\n    return File;\n})();\n\nexports.default = File;\n\n},{}],20:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _File = require('./File');\n\nvar _File2 = _interopRequireDefault(_File);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FilePickerController = (function () {\n\n    /*@ngInject*/\n\n    function FilePickerController(api) {\n        _classCallCheck(this, FilePickerController);\n\n        this.api = api;\n        this.files = [];\n        this.preview = null;\n        this.searchText = '';\n\n        this.loadFiles();\n    }\n\n    _createClass(FilePickerController, [{\n        key: 'selectLabel',\n        value: function selectLabel() {\n            var label = 'Select file';\n\n            if (this.isMultiple()) {\n                label += 's';\n            }\n\n            label += \" ( \" + this.selectedFiles().length + \" )\";\n\n            return label;\n        }\n    }, {\n        key: 'showModal',\n        value: function showModal($event) {\n            var target = $event.target;\n\n            $(target).prev().modal();\n        }\n    }, {\n        key: 'loadFiles',\n        value: function loadFiles() {\n            var _this = this;\n\n            this.api.files().then(function (apiFiles) {\n                apiFiles.forEach(function (apiFile) {\n                    var file = new _File2.default(apiFile);\n\n                    if (_this.fileType && file.type !== _this.fileType) {\n                        return;\n                    }\n\n                    _this.files.push(file);\n                });\n            });\n        }\n    }, {\n        key: 'filteredFiles',\n        value: function filteredFiles() {\n            var _this2 = this;\n\n            if (this.searchText.length > 0) {\n                return this.files.filter(function (file) {\n                    return file.name.indexOf(_this2.searchText) !== -1;\n                });\n            }\n\n            return this.files;\n        }\n    }, {\n        key: 'setPreview',\n        value: function setPreview(file) {\n            if (file.isImage()) {\n                this.preview = file;\n            }\n        }\n    }, {\n        key: 'previewSource',\n        value: function previewSource() {\n            if (this.preview) {\n                return this.preview.url;\n            }\n\n            return '';\n        }\n    }, {\n        key: 'hidePreview',\n        value: function hidePreview() {\n            this.preview = null;\n        }\n    }, {\n        key: 'leftColumnClass',\n        value: function leftColumnClass() {\n            if (this.previewSource()) {\n                return 'col-xs-6';\n            }\n\n            return 'col-xs-12';\n        }\n    }, {\n        key: 'isMultiple',\n        value: function isMultiple() {\n            return this.multiple !== undefined;\n        }\n    }, {\n        key: 'onSelect',\n        value: function onSelect(selectedFile) {\n            if (!this.isMultiple()) {\n                this.files.forEach(function (file) {\n                    return file.selected = false;\n                });\n\n                selectedFile.selected = true;\n            }\n        }\n    }, {\n        key: 'selectedFiles',\n        value: function selectedFiles() {\n            return this.files.filter(function (file) {\n                return file.selected;\n            });\n        }\n    }, {\n        key: 'disableSelectButton',\n        value: function disableSelectButton() {\n            return this.selectedFiles().length === 0;\n        }\n    }, {\n        key: 'selectButtonLabel',\n        value: function selectButtonLabel() {\n            var selected = this.selectedFiles().length;\n\n            if (selected === 0) {\n                return 'Please choose a file first';\n            }\n\n            return 'Select ' + selected + ' file' + (selected !== 1 ? 's' : '');\n        }\n    }, {\n        key: 'confirmSelected',\n        value: function confirmSelected() {\n            var selected = this.selectedFiles();\n            var $field = $('input[name=\"' + this.name + '\"]');\n\n            if (selected.length === 1) {\n                $field.val(selected[0].id);\n\n                return;\n            }\n\n            var fileIds = [];\n\n            selected.forEach(function (file) {\n                return fileIds.push(file.id);\n            });\n            $field.val(fileIds);\n        }\n    }, {\n        key: 'countSelected',\n        value: function countSelected() {\n            return this.selectedFiles().length;\n        }\n    }]);\n\n    return FilePickerController;\n})();\n\nexports.default = FilePickerController;\n\n},{\"./File\":19}],21:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _File2 = require('./File');\n\nvar _File3 = _interopRequireDefault(_File2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Folder = (function (_File) {\n    _inherits(Folder, _File);\n\n    function Folder(name) {\n        var parent = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\n        _classCallCheck(this, Folder);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Folder).call(this, name, name, ''));\n\n        _this.parent = parent;\n        _this.type = 'folder';\n        _this.isFolder = true;\n        _this.files = [];\n        return _this;\n    }\n\n    return Folder;\n})(_File3.default);\n\nexports.default = Folder;\n\n},{\"./File\":19}],22:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _Category = require('./Category');\n\nvar _Category2 = _interopRequireDefault(_Category);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = [new _Category2.default('Everything', 'ion-ios-home', null, true), new _Category2.default('Images', 'ion-ios-photos', imageFilter), new _Category2.default('Videos', 'ion-ios-videocam', videoFilter), new _Category2.default('Audio', 'ion-ios-mic', audioFilter), new _Category2.default('Documents', 'ion-ios-paper', documentFilter)];\n\nfunction imageFilter(file) {\n    return file.isImage();\n}\n\nfunction videoFilter(file) {\n    return file.isVideo();\n}\n\nfunction audioFilter(file) {\n    return file.isAudio();\n}\n\nfunction documentFilter(file) {\n    return file.isDocument();\n}\n\n},{\"./Category\":17}],23:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = draggableDirective;\nfunction draggableDirective() {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        $(element).draggable({\n            axis: 'y',\n            containment: 'table',\n            helper: 'clone',\n            revert: true\n        });\n    }\n}\n\n},{}],24:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = droppableDirective;\nfunction droppableDirective() {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        var $element = $(element);\n        var droppable = attributes.mezzoDroppable;\n        var controller = scope.vm;\n\n        if (droppable === 'true') {\n            $element.droppable({\n                hoverClass: 'success',\n                drop: function drop(event, ui) {\n                    var draggable = ui.draggable;\n\n                    ui.helper.remove();\n                    controller.onDrop(element, draggable);\n                }\n            });\n        }\n    }\n}\n\n},{}],25:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = filePickerDirective;\n\nvar _FilePickerController = require('./FilePickerController');\n\nvar _FilePickerController2 = _interopRequireDefault(_FilePickerController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*@ngInject*/\nfunction filePickerDirective() {\n    return {\n        restrict: 'E',\n        templateUrl: '/mezzolabs/mezzo/cockpit/templates/filePickerDirective.html',\n        scope: {\n            fileType: '@',\n            fieldName: '@',\n            multiple: '@',\n            name: '@'\n        },\n        controller: _FilePickerController2.default,\n        controllerAs: 'vm',\n        bindToController: true\n    };\n}\n\n},{\"./FilePickerController\":20}],26:[function(require,module,exports){\n'use strict';\n\nvar _draggableDirective = require('./draggableDirective.js');\n\nvar _draggableDirective2 = _interopRequireDefault(_draggableDirective);\n\nvar _droppableDirective = require('./droppableDirective.js');\n\nvar _droppableDirective2 = _interopRequireDefault(_droppableDirective);\n\nvar _filePickerDirective = require('./filePickerDirective');\n\nvar _filePickerDirective2 = _interopRequireDefault(_filePickerDirective);\n\nvar _CreateFileController = require('./CreateFileController');\n\nvar _CreateFileController2 = _interopRequireDefault(_CreateFileController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _module = angular.module('MezzoFileManager', []);\n\n_module.directive('mezzoDraggable', _draggableDirective2.default);\n_module.directive('mezzoDroppable', _droppableDirective2.default);\n_module.directive('mezzoFilePicker', _filePickerDirective2.default);\n_module.controller('CreateFileController', _CreateFileController2.default);\n\n},{\"./CreateFileController\":18,\"./draggableDirective.js\":23,\"./droppableDirective.js\":24,\"./filePickerDirective\":25}],27:[function(require,module,exports){\n'use strict';\n\nvar _mapService = require('./mapService');\n\nvar _mapService2 = _interopRequireDefault(_mapService);\n\nvar _mapDirective = require('./mapDirective');\n\nvar _mapDirective2 = _interopRequireDefault(_mapDirective);\n\nvar _searchDirective = require('./searchDirective');\n\nvar _searchDirective2 = _interopRequireDefault(_searchDirective);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _module = angular.module('MezzoGoogleMaps', []);\n\n_module.factory('mapService', _mapService2.default);\n_module.directive('mezzoGoogleMap', _mapDirective2.default);\n_module.directive('mezzoGoogleMapsSearch', _searchDirective2.default);\n\n},{\"./mapDirective\":28,\"./mapService\":29,\"./searchDirective\":30}],28:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = mapDirective;\n/*@ngInject*/\nfunction mapDirective(mapService) {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        var actualElement = element[0];\n        var map = new google.maps.Map(actualElement, {\n            mapTypeId: google.maps.MapTypeId.ROADMAP,\n            zoom: 13,\n            center: { lat: -33.8688, lng: 151.2195 }\n        });\n        mapService.map = map;\n\n        if (navigator.geolocation) {\n            navigator.geolocation.getCurrentPosition(function (position) {\n                var currentLatLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n\n                map.setCenter(currentLatLng);\n            });\n        }\n    }\n}\n\n},{}],29:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = mapService;\n/*@ngInject*/\nfunction mapService() {\n    return {\n        map: null\n    };\n}\n\n},{}],30:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = searchDirective;\n/*@ngInject*/\nfunction searchDirective(mapService) {\n    return {\n        restrict: 'A',\n        scope: {\n            streetNumber: '@',\n            street: '@',\n            city: '@',\n            state: '@',\n            country: '@',\n            postalCode: '@',\n            latitude: '@',\n            longitude: '@'\n        },\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        var input = element[0];\n        var autoCompleteOptions = {\n            types: ['geocode']\n        };\n        var autoComplete = new google.maps.places.Autocomplete(input, autoCompleteOptions);\n\n        autoComplete.addListener('place_changed', function () {\n            var place = autoComplete.getPlace();\n            var addressComponents = place.address_components;\n            var componentForm = {\n                street_number: {\n                    key: 'short_name',\n                    selector: scope.streetNumber\n                },\n                route: {\n                    key: 'long_name',\n                    selector: scope.street\n                },\n                locality: {\n                    key: 'long_name',\n                    selector: scope.city\n                },\n                administrative_area_level_1: {\n                    key: 'long_name',\n                    selector: scope.state\n                },\n                country: {\n                    key: 'long_name',\n                    selector: scope.country\n                },\n                postal_code: {\n                    key: 'short_name',\n                    selector: scope.postalCode\n                }\n            };\n\n            addressComponents.forEach(function (component) {\n                var componentType = component.types[0];\n                var componentOptions = componentForm[componentType];\n\n                if (componentOptions) {\n                    var componentKey = componentOptions.key;\n                    var componentSelector = componentOptions.selector;\n                    var componentValue = component[componentKey];\n\n                    $('[name=\"' + componentSelector + '\"]').val(componentValue);\n                }\n            });\n        });\n\n        if (navigator.geolocation) {\n            navigator.geolocation.getCurrentPosition(function (position) {\n                var geolocation = {\n                    lat: position.coords.latitude,\n                    lng: position.coords.longitude\n                };\n                var circle = new google.maps.Circle({\n                    center: geolocation,\n                    radius: position.coords.accuracy\n                });\n                var bounds = circle.getBounds();\n\n                autoComplete.setBounds(bounds);\n            });\n        }\n    }\n}\n\n},{}],31:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = {\n    INDEX: 'index',\n    CREATE: 'create',\n    EDIT: 'edit',\n    SHOW: 'show'\n};\n\n},{}],32:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CreateResourceController = (function () {\n\n    /*@ngInject*/\n\n    function CreateResourceController($state, api, formDataService, contentBlockFactory) {\n        _classCallCheck(this, CreateResourceController);\n\n        this.$state = $state;\n        this.api = api;\n        this.formDataService = formDataService;\n        this.contentBlockService = contentBlockFactory();\n    }\n\n    _createClass(CreateResourceController, [{\n        key: 'init',\n        value: function init(modelName) {\n            this.modelName = modelName;\n            this.modelApi = this.api.model(this.modelName);\n        }\n    }, {\n        key: 'submit',\n        value: function submit() {\n            var _this = this;\n\n            if (this.form.$invalid) {\n                return false;\n            }\n\n            var formData = this.formDataService.get();\n\n            this.modelApi.create(formData).then(function (model) {\n                _this.edit(model.id);\n            });\n        }\n    }, {\n        key: 'hasError',\n        value: function hasError(formControl) {\n            if (Object.keys(formControl.$error).length && formControl.$dirty) {\n                return 'has-error';\n            }\n        }\n    }, {\n        key: 'edit',\n        value: function edit(modelId) {\n            this.$state.go('edit' + this.modelName.toLowerCase(), { modelId: modelId });\n        }\n    }]);\n\n    return CreateResourceController;\n})();\n\nexports.default = CreateResourceController;\n\n},{}],33:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar EditResourceController = (function () {\n\n    /*@ngInject*/\n\n    function EditResourceController($scope, $stateParams, api, formDataService, contentBlockFactory) {\n        var _this = this;\n\n        _classCallCheck(this, EditResourceController);\n\n        this.$scope = $scope;\n        this.$stateParams = $stateParams;\n        this.api = api;\n        this.formDataService = formDataService;\n        this.contentBlockService = contentBlockFactory();\n        this.modelId = this.$stateParams.modelId;\n\n        this.$scope.$on('$destroy', function () {\n            return _this.onDestroy();\n        });\n    }\n\n    _createClass(EditResourceController, [{\n        key: 'init',\n        value: function init(modelName) {\n            this.modelName = modelName;\n            this.modelApi = this.api.model(modelName);\n\n            this.loadContent();\n            this.startResourceLocking();\n        }\n    }, {\n        key: 'submit',\n        value: function submit() {\n            if (this.form.$invalid) {\n                return false;\n            }\n\n            var formData = this.formDataService.get();\n\n            this.modelApi.update(this.modelId, formData).then(function (model) {\n                console.log(model);\n            });\n        }\n    }, {\n        key: 'getFormData',\n        value: function getFormData() {\n            var $form = $('form[name=\"vm.form\"]');\n\n            return $form.toObject();\n        }\n    }, {\n        key: 'loadContent',\n        value: function loadContent() {\n            var _this2 = this;\n\n            this.modelApi.content(this.modelId).then(function (model) {\n                var blocks = model.content.data.blocks.data;\n\n                blocks.forEach(function (block) {\n                    var hash = md5(block.class);\n\n                    _this2.contentBlockService.addContentBlock(block.class, hash, block._label, block.id);\n                });\n\n                _this2.formDataService.set(model);\n            });\n        }\n    }, {\n        key: 'startResourceLocking',\n        value: function startResourceLocking() {\n            var _this3 = this;\n\n            var thirtySeconds = 30 * 1000;\n            this.lockTask = setInterval(function () {\n                return _this3.lock();\n            }, thirtySeconds);\n\n            this.lock();\n        }\n    }, {\n        key: 'stopResourceLocking',\n        value: function stopResourceLocking() {\n            clearInterval(this.lockTask);\n        }\n    }, {\n        key: 'lock',\n        value: function lock() {\n            this.modelApi.lock(this.modelId);\n        }\n    }, {\n        key: 'onDestroy',\n        value: function onDestroy() {\n            console.log('Well, looks like I have been murdered.');\n            this.stopResourceLocking();\n        }\n    }]);\n\n    return EditResourceController;\n})();\n\nexports.default = EditResourceController;\n\n},{}],34:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _typeof(obj) { return obj && typeof Symbol !== \"undefined\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar IndexResourceController = (function () {\n\n    /*@ngInject*/\n\n    function IndexResourceController($scope, $state, api) {\n        _classCallCheck(this, IndexResourceController);\n\n        this.$scope = $scope;\n        this.$state = $state;\n        this.api = api;\n        this.includes = [];\n        this.models = [];\n        this.searchText = '';\n        this.selectAll = false;\n        this.loading = false;\n        this.removing = 0;\n        this.attributes = [];\n    }\n\n    _createClass(IndexResourceController, [{\n        key: 'init',\n        value: function init(modelName, defaultIncludes) {\n            this.modelName = modelName;\n            this.modelApi = this.api.model(modelName);\n            this.includes = defaultIncludes;\n\n            this.loadModels();\n        }\n    }, {\n        key: 'addAttribute',\n        value: function addAttribute(name, type) {\n            this.attributes.push({ name: name, type: type });\n        }\n    }, {\n        key: 'loadModels',\n        value: function loadModels() {\n            var _this = this;\n\n            this.loading = true;\n\n            var parameters = {\n                'include': this.includes.join(',')\n            };\n\n            return this.modelApi.index(parameters).then(function (data) {\n                _this.loading = false;\n                _this.models = data;\n\n                _this.models.forEach(function (model) {\n                    return model._meta = {};\n                });\n            });\n        }\n    }, {\n        key: 'getModels',\n        value: function getModels() {\n            if (this.searchText.length > 0) {\n                return this.search();\n            }\n\n            return this.models;\n        }\n    }, {\n        key: 'getModelKeys',\n        value: function getModelKeys(model) {\n            if (this.models.length > 0 && !model) {\n                model = this.models[0];\n            }\n\n            if (!model) {\n                return [];\n            }\n\n            var keys = Object.keys(model);\n\n            return keys.filter(function (key) {\n                return key !== '_meta' && model.hasOwnProperty(key);\n            });\n        }\n    }, {\n        key: 'getModelValues',\n        value: function getModelValues(model) {\n            var values = [];\n\n            for (var i in this.attributes) {\n                var attribute = this.attributes[i];\n                values.push(this.transformModelValue(attribute, model[attribute.name]));\n            }\n\n            return values;\n        }\n    }, {\n        key: 'transformModelValue',\n        value: function transformModelValue(attribute, value) {\n\n            if (value && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === \"object\") {\n\n                if (Object.prototype.toString.call(value.data) === \"[object Array]\") {\n                    return this.transformArrayValueToString(name, value.data);\n                }\n\n                if (Object.prototype.toString.call(value.data) === \"[object Object]\") {\n                    return this.transformObjectValueToString(name, value.data);\n                }\n            }\n\n            if (value && attribute.type == \"datetime\") {\n                return moment(value).format('DD.MM.YYYY hh:mm');\n            }\n\n            if (attribute.type == \"boolean\") {\n                return value == \"1\" ? \"y\" : \"n\";\n            }\n\n            return value;\n        }\n    }, {\n        key: 'transformArrayValueToString',\n        value: function transformArrayValueToString(name, array) {\n            var labels = [];\n\n            for (var i in array) {\n                labels.push(this.transformObjectValueToString(name, array[i]));\n            }\n\n            return labels.join(', ');\n        }\n    }, {\n        key: 'transformObjectValueToString',\n        value: function transformObjectValueToString(name, object) {\n            return object._label;\n        }\n    }, {\n        key: 'canEdit',\n        value: function canEdit() {\n            return this.selected().length === 1;\n        }\n    }, {\n        key: 'canRemove',\n        value: function canRemove() {\n            return this.selected().length > 0;\n        }\n    }, {\n        key: 'search',\n        value: function search() {\n            var _this2 = this;\n\n            return this.models.filter(function (model) {\n                for (var key in model) {\n                    if (model.hasOwnProperty(key)) {\n                        var value = model[key];\n\n                        if (String(value).indexOf(_this2.searchText) !== -1) {\n                            return true;\n                        }\n                    }\n                }\n            });\n        }\n    }, {\n        key: 'updateSelectAll',\n        value: function updateSelectAll() {\n            var _this3 = this;\n\n            var models = this.getModels();\n\n            models.forEach(function (model) {\n                return model._meta.selected = _this3.selectAll;\n            });\n        }\n    }, {\n        key: 'selected',\n        value: function selected() {\n            return this.models.filter(function (model) {\n                return model._meta.selected;\n            });\n        }\n    }, {\n        key: 'create',\n        value: function create() {}\n    }, {\n        key: 'editId',\n        value: function editId(id) {\n            this.$state.go('edit' + this.modelName, { modelId: id });\n        }\n    }, {\n        key: 'remove',\n        value: function remove() {\n            var _this4 = this;\n\n            var selected = this.selected();\n\n            swal({\n                title: 'Are you sure?',\n                text: selected.length + ' models will be deleted!',\n                type: 'warning',\n                showCancelButton: true,\n                confirmButtonText: 'Yes, delete them!',\n                confirmButtonColor: '#fb503b'\n            }, function (confirmed) {\n                if (!confirmed) {\n                    return;\n                }\n\n                selected.forEach(function (model) {\n                    return _this4.removeModel(model);\n                });\n            });\n        }\n    }, {\n        key: 'removeModel',\n        value: function removeModel(model) {\n            var _this5 = this;\n\n            this.removing++;\n            this.selectAll = false;\n            model._meta.selected = false;\n            model._meta.removed = true;\n\n            this.removeRemoteModel(model).then(function () {\n                return _this5.removeLocalModel(model);\n            }).catch(function () {\n                return _this5.removing--;\n            });\n        }\n    }, {\n        key: 'removeLocalModel',\n        value: function removeLocalModel(model) {\n            for (var i = 0; i < this.models.length; i++) {\n                if (this.models[i] === model) {\n                    return this.models.splice(i, 1);\n                }\n            }\n        }\n    }, {\n        key: 'removeRemoteModel',\n        value: function removeRemoteModel(model) {\n            return this.modelApi.delete(model.id);\n        }\n    }, {\n        key: 'countSelected',\n        value: function countSelected() {\n            return this.selected().length;\n        }\n    }, {\n        key: 'isLocked',\n        value: function isLocked(model) {\n            return model._locked_for_user;\n        }\n    }, {\n        key: 'lockedBy',\n        value: function lockedBy(model) {\n            return model._locked_by;\n        }\n    }, {\n        key: 'displayAsLink',\n        value: function displayAsLink($first, model) {\n            return $first && !this.isLocked(model);\n        }\n    }]);\n\n    return IndexResourceController;\n})();\n\nexports.default = IndexResourceController;\n\n},{}],35:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ShowResourceController =\n\n/*@ngInject*/\nfunction ShowResourceController() {\n    _classCallCheck(this, ShowResourceController);\n};\n\nexports.default = ShowResourceController;\n\n},{}],36:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FormDataService = (function () {\n    function FormDataService() {\n        _classCallCheck(this, FormDataService);\n    }\n\n    _createClass(FormDataService, [{\n        key: 'form',\n        value: function form() {\n            return $('form[name=\"vm.form\"]');\n        }\n    }, {\n        key: 'get',\n        value: function get() {\n            return this.form().toObject();\n        }\n    }, {\n        key: 'set',\n        value: function set(formData) {\n            js2form(this.form()[0], formData);\n        }\n    }]);\n\n    return FormDataService;\n})();\n\nexports.default = FormDataService;\n\n},{}],37:[function(require,module,exports){\n'use strict';\n\nvar _stateProvider = require('./stateProvider');\n\nvar _stateProvider2 = _interopRequireDefault(_stateProvider);\n\nvar _formDataService = require('./formDataService');\n\nvar _formDataService2 = _interopRequireDefault(_formDataService);\n\nvar _registerStateDirective = require('./registerStateDirective');\n\nvar _registerStateDirective2 = _interopRequireDefault(_registerStateDirective);\n\nvar _IndexResourceController = require('./IndexResourceController');\n\nvar _IndexResourceController2 = _interopRequireDefault(_IndexResourceController);\n\nvar _CreateResourceController = require('./CreateResourceController');\n\nvar _CreateResourceController2 = _interopRequireDefault(_CreateResourceController);\n\nvar _EditResourceController = require('./EditResourceController');\n\nvar _EditResourceController2 = _interopRequireDefault(_EditResourceController);\n\nvar _ShowResourceController = require('./ShowResourceController');\n\nvar _ShowResourceController2 = _interopRequireDefault(_ShowResourceController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _module = angular.module('MezzoResources', []);\n\n_module.provider('$stateProvider', _stateProvider2.default);\n_module.service('formDataService', _formDataService2.default);\n_module.directive('mezzoRegisterState', _registerStateDirective2.default);\n_module.controller('IndexResourceController', _IndexResourceController2.default);\n_module.controller('CreateResourceController', _CreateResourceController2.default);\n_module.controller('EditResourceController', _EditResourceController2.default);\n_module.controller('ShowResourceController', _ShowResourceController2.default);\n\n},{\"./CreateResourceController\":32,\"./EditResourceController\":33,\"./IndexResourceController\":34,\"./ShowResourceController\":35,\"./formDataService\":36,\"./registerStateDirective\":38,\"./stateProvider\":39}],38:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = registerStateDirective;\n\nvar _Action = require('./Action');\n\nvar _Action2 = _interopRequireDefault(_Action);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*@ngInject*/\nfunction registerStateDirective($stateProvider, hasController) {\n    return {\n        restrict: 'A',\n        link: link\n    };\n\n    function link(scope, element, attributes) {\n        var uri = attributes.uri;\n        var page = attributes.page;\n        var action = attributes.action;\n\n        registerState(uri, page, action);\n\n        if (action === _Action2.default.CREATE) {\n            registerState(uri.replace('create', 'edit'), page.replace('Create', 'Edit'), _Action2.default.EDIT);\n        }\n    }\n\n    function registerState(uri, page, action) {\n        var stateName = page.toLowerCase();\n        var url = urlForAction(uri, action);\n        var controller = controllerForPage(page);\n\n        if (!controller) {\n            controller = controllerForAction(action);\n        }\n\n        $stateProvider.state(stateName, {\n            url: url,\n            templateUrl: '/mezzo/' + uri + '.html',\n            controller: controller,\n            controllerAs: 'vm'\n        });\n    }\n\n    function controllerForPage(page) {\n        var controllerName = page + 'Controller';\n\n        if (hasController(controllerName)) {\n            console.info('Found custom ' + controllerName);\n\n            return controllerName;\n        }\n\n        return null;\n    }\n\n    function controllerForAction(action) {\n        if (action === _Action2.default.INDEX) {\n            return 'IndexResourceController';\n        }\n\n        if (action === _Action2.default.CREATE) {\n            return 'CreateResourceController';\n        }\n\n        if (action === _Action2.default.EDIT) {\n            return 'EditResourceController';\n        }\n\n        if (action === _Action2.default.SHOW) {\n            return 'ShowResourceController';\n        }\n\n        throw new Error('No suitable Controller found for action \"' + action + '\"!');\n    }\n\n    function urlForAction(uri, action) {\n        var url = '/mezzo/' + uri;\n\n        if (action === _Action2.default.EDIT) {\n            return url + '/:modelId';\n        }\n\n        return url;\n    }\n}\n\n},{\"./Action\":31}],39:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = stateProvider;\n/*@ngInject*/\nfunction stateProvider($stateProvider) {\n    this.$get = $get;\n\n    function $get() {\n        return $stateProvider;\n    }\n}\n\n},{}],40:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = config;\n/*@ngInject*/\nfunction config($locationProvider, $urlRouterProvider, $httpProvider) {\n    $httpProvider.defaults.headers.common.Accept = 'application/vnd.MezzoLabs.v1+json';\n\n    $locationProvider.html5Mode(true);\n}\n\n},{}],41:[function(require,module,exports){\n'use strict';\n\n$(function () {\n    $('.sidebar-pin').click(function () {\n        var sidebarIsPinned = $('body').hasClass('sidebar-pinned');\n\n        if (sidebarIsPinned) {\n            $('body').addClass('sidebar-unpinned').removeClass('sidebar-pinned');\n            $(this).addClass('fa-circle-o').removeClass('fa-dot-circle-o');\n        } else {\n            $('body').addClass('sidebar-pinned').removeClass('sidebar-unpinned');\n            $(this).addClass('fa-dot-circle-o').removeClass('fa-circle-o');\n        }\n    });\n\n    $('#sidebar').mouseenter(function () {\n        $('body').addClass('sidebar-mousein').removeClass('sidebar-mouseout');\n    });\n\n    $('#sidebar').mouseleave(function () {\n        $('body').addClass('sidebar-mouseout').removeClass('sidebar-mousein');\n\n        if ($('body').hasClass('sidebar-unpinned')) $('.nav-main .opened').removeClass('opened');\n    });\n\n    $('.nav-main > li.has-pages > a .dropdown').click(function () {\n        $(this).parents('li').toggleClass('opened');\n    });\n\n    $('.trigger-quickview').click(function () {\n        quickviewVisible(!quickviewIsVisible());\n        return false;\n    });\n\n    $('#quickview .btn-close').click(function () {\n        quickviewVisible(false);\n    });\n\n    $('#content-main, #view-overlay').click(function () {\n        quickviewVisible(false);\n    });\n\n    function quickviewIsVisible() {\n        return $('#quickview').hasClass('opened');\n    }\n\n    function quickviewVisible(open) {\n        if (open) {\n            $('#quickview').addClass('opened');\n            $('#view-overlay').addClass('opened');\n        } else {\n            $('#quickview').removeClass('opened');\n            $('#view-overlay').removeClass('opened');\n        }\n    }\n\n    /**\n     * Form stuff\n     */\n    $.fn.editable.defaults.mode = 'inline';\n\n    $.fn.editableform.buttons = '<button type=\"submit\" class=\"btn btn-primary btn-sm editable-submit\">' + '<i class=ion-checkmark></i>' + '</button>' + '<button type=\"button\" class=\"btn btn-default btn-sm editable-cancel\">' + '<i class=\"ion-close\"></i>' + '</button>';\n\n    $('.editable').editable();\n\n    //$('select').select2(); uncomment for model builder\n});\n\n},{}]},{},[1]);\n"],"file":"app.js","sourceRoot":"/source/"}